---

title: Title

keywords: fastai
sidebar: home_sidebar



---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: 07-identify_rural_tracts.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Explore rural census tracts in metro counties (CBSAs) and urban areas (UAs).</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">geopandas</span> <span class="k">as</span> <span class="nn">gpd</span>
<span class="kn">from</span> <span class="nn">shapely.geometry</span> <span class="kn">import</span> <span class="n">Point</span><span class="p">,</span> <span class="n">Polygon</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">rural_tracts</span> <span class="o">=</span> <span class="p">[</span><span class="n">line</span><span class="o">.</span><span class="n">rstrip</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;data/rural_census_tracts.lis&quot;</span><span class="p">)]</span>
<span class="nb">len</span><span class="p">(</span><span class="n">rural_tracts</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>2302</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Combine the state-level Census shapefiles. VERY compact code.</span>
<span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>
<span class="n">pathlist</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;/InfoGroup/rural/map_files/tracts/&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s2">&quot;*.shp&quot;</span><span class="p">)</span>

<span class="n">gdf</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">gpd</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="n">shp</span><span class="p">)</span> <span class="k">for</span> <span class="n">shp</span> <span class="ow">in</span> <span class="n">pathlist</span><span class="p">])</span><span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">gpd</span><span class="o">.</span><span class="n">GeoDataFrame</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">gdf</span><span class="o">.</span><span class="n">to_file</span><span class="p">(</span><span class="s2">&quot;/InfoGroup/rural/map_files/tracts/tl_2017_USA_tract.shp&quot;</span><span class="p">,</span><span class="n">driver</span><span class="o">=</span><span class="s1">&#39;ESRI Shapefile&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Compute the centroid of the polygon</span>
<span class="n">gdf</span><span class="p">[</span><span class="s1">&#39;centroid&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">gdf</span><span class="p">[</span><span class="s1">&#39;geometry&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">Point</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">centroid</span><span class="p">))</span> <span class="c1"># shapely methods</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">gdf</span><span class="o">.</span><span class="n">columns</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">gdf</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Now find out if the centroid is inside a UA. UAs do not respect political boundaries so a single</span>
<span class="c1"># census tract could be in multiple UAs -- although census tracts are much smaller than UAs and </span>
<span class="c1"># UAs are discontinuous in space, so there must be very few tracts that overlap multiple UAs -- </span>
<span class="c1"># and a single census tract could be fractionally rural or urban. </span>

<span class="c1"># If we don&#39;t want to be concerned with fractions of census tracts, dividing up the continuous </span>
<span class="c1"># measures by the same fraction, it is reasonable to say that a &#39;Census-urban&#39; census tract is </span>
<span class="c1"># one whose centroid falls within a particular UA and to call that UA the one to which it belongs.</span>

<span class="c1"># We know that all census tracts are wholly within or wholly outside a CBSA because they do not </span>
<span class="c1"># cross county boundaries. So &#39;OMB-rural&#39; census tracts are in &#39;OMB-rural&#39; counties.</span>

<span class="c1"># &quot;Each census tract contains at least one BG [ed.,block group], and BGs are uniquely numbered </span>
<span class="c1"># within the census tract. Within the standard census geographic hierarchy, BGs never cross state,</span>
<span class="c1"># county, or census tract boundaries but may cross the boundaries of any other geographic entity.&quot;</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># File that contains polygon geometry of UAs for 2017</span>
<span class="n">ua_gdf</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="s1">&#39;map_files/tl_2017_us_uac10.shp&#39;</span><span class="p">)</span>
<span class="n">ua_gdf</span><span class="o">.</span><span class="n">columns</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>Index([&#39;UACE10&#39;, &#39;GEOID10&#39;, &#39;NAME10&#39;, &#39;NAMELSAD10&#39;, &#39;LSAD10&#39;, &#39;MTFCC10&#39;,
       &#39;UATYP10&#39;, &#39;FUNCSTAT10&#39;, &#39;ALAND10&#39;, &#39;AWATER10&#39;, &#39;INTPTLAT10&#39;,
       &#39;INTPTLON10&#39;, &#39;geometry&#39;],
      dtype=&#39;object&#39;)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">ua_gdf</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>UACE10</th>
      <th>GEOID10</th>
      <th>NAME10</th>
      <th>NAMELSAD10</th>
      <th>LSAD10</th>
      <th>MTFCC10</th>
      <th>UATYP10</th>
      <th>FUNCSTAT10</th>
      <th>ALAND10</th>
      <th>AWATER10</th>
      <th>INTPTLAT10</th>
      <th>INTPTLON10</th>
      <th>geometry</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>24310</td>
      <td>24310</td>
      <td>Dixon, IL</td>
      <td>Dixon, IL Urban Cluster</td>
      <td>76</td>
      <td>G3500</td>
      <td>C</td>
      <td>S</td>
      <td>25525003</td>
      <td>938058</td>
      <td>+41.8529507</td>
      <td>-089.4817439</td>
      <td>POLYGON ((-89.498589 41.854668, -89.498538 41....</td>
    </tr>
    <tr>
      <td>1</td>
      <td>27847</td>
      <td>27847</td>
      <td>Escanaba, MI</td>
      <td>Escanaba, MI Urban Cluster</td>
      <td>76</td>
      <td>G3500</td>
      <td>C</td>
      <td>S</td>
      <td>46648248</td>
      <td>283456</td>
      <td>+45.8704839</td>
      <td>-087.0638396</td>
      <td>(POLYGON ((-87.063103 45.866083, -87.062210999...</td>
    </tr>
    <tr>
      <td>2</td>
      <td>18100</td>
      <td>18100</td>
      <td>Clintonville, WI</td>
      <td>Clintonville, WI Urban Cluster</td>
      <td>76</td>
      <td>G3500</td>
      <td>C</td>
      <td>S</td>
      <td>5854683</td>
      <td>502563</td>
      <td>+44.6232203</td>
      <td>-088.7611283</td>
      <td>POLYGON ((-88.78650499999999 44.629957, -88.78...</td>
    </tr>
    <tr>
      <td>3</td>
      <td>06166</td>
      <td>06166</td>
      <td>Bedford, IN</td>
      <td>Bedford, IN Urban Cluster</td>
      <td>76</td>
      <td>G3500</td>
      <td>C</td>
      <td>S</td>
      <td>30402519</td>
      <td>2314</td>
      <td>+38.8566530</td>
      <td>-086.5012383</td>
      <td>(POLYGON ((-86.518316 38.79547, -86.518253 38....</td>
    </tr>
    <tr>
      <td>4</td>
      <td>75270</td>
      <td>75270</td>
      <td>Riverdale, CA</td>
      <td>Riverdale, CA Urban Cluster</td>
      <td>76</td>
      <td>G3500</td>
      <td>C</td>
      <td>S</td>
      <td>2306823</td>
      <td>0</td>
      <td>+36.4310710</td>
      <td>-119.8620544</td>
      <td>POLYGON ((-119.869132 36.430832, -119.870931 3...</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">gdf</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ua_gdf</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%%time</span>
<span class="c1"># Count the overlap of tracts in UAs </span>
<span class="n">overlap_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="o">.</span><span class="n">fromkeys</span><span class="p">(</span><span class="n">ua_gdf</span><span class="p">[</span><span class="s1">&#39;GEOID10&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span><span class="mi">0</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">ua</span> <span class="ow">in</span> <span class="n">ua_gdf</span><span class="p">[[</span><span class="s1">&#39;GEOID10&#39;</span><span class="p">,</span><span class="s1">&#39;geometry&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
    <span class="k">for</span> <span class="n">j</span><span class="p">,</span><span class="n">ct</span> <span class="ow">in</span> <span class="n">gdf</span><span class="p">[</span><span class="s1">&#39;centroid&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iteritems</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">ua</span><span class="p">[</span><span class="s1">&#39;geometry&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">ct</span><span class="p">):</span>
                <span class="n">overlap_dict</span><span class="p">[</span><span class="n">ua</span><span class="p">[</span><span class="s1">&#39;GEOID10&#39;</span><span class="p">]]</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="k">break</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">cdf</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">overlap_dict</span><span class="p">,</span><span class="n">orient</span><span class="o">=</span><span class="s1">&#39;index&#39;</span><span class="p">,</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;count&#39;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># This shows that no UA contains the centroid of more than one census tract.</span>
<span class="n">cdf</span><span class="p">[</span><span class="s1">&#39;count&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}
# See the python program tracts.py in /InfoGroup/rural/points-in-polygons/ for execution of this code
# to assign a UA code to each census tract whoise centroid falls within a UA.
%%time
# Assign a UA code 
gdf['UA Code'] = '99999'
for j,ct in gdf.iterrows():
    for i,ua in ua_gdf.iterrows():
        if ct['centroid'].within(ua['geometry']):
            gdf.loc[j]['UA Code'] = ua['GEOID10']
            break
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># -----------------------</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># InfoGroup for 2017 has data on 82,385 census tracts for all. The HRSA/FORHP file </span>
<span class="c1"># of rural units lists 2,302 rural census tracts in addition to all those in non-Metro counties. The Census&#39;s </span>
<span class="c1"># Zip Code-to-Census Tracts relationship file identifies 74,091 census tracts in all states(below).</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># The ID of a census tract is the combination of the state FIPS, county FIPS, and tract number.</span>
<span class="n">infile</span> <span class="o">=</span> <span class="s1">&#39;/home/tflory/Relationship_Files/Census_Tract_to_PUMA.csv&#39;</span>
<span class="n">ct_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">infile</span><span class="p">,</span><span class="n">usecols</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;STATEFP&#39;</span><span class="p">,</span><span class="s1">&#39;COUNTYFP&#39;</span><span class="p">,</span><span class="s1">&#39;TRACTCE&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">ct_df</span><span class="p">[</span><span class="s1">&#39;STATEFP&#39;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="mi">56</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

</div>
 

 13939 non-null object
County                                       13939 non-null object
Tract                                        13939 non-null int64
Primary RUCA Code 2010                       13939 non-null int64
Secondary RUCA Code 2010                     13939 non-null object
Tract Population 2010                        13939 non-null object
Land Area (square miles) 2010                13939 non-null float64
Population Density (per square mile) 2010    13579 non-null float64
dtypes: float64(2), int64(2), object(5)
memory usage: 1.1+ MB
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">all_rural_tracts</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;/InfoGroup/rural/points-in-polygons/data/rural_HRSA_updated_tracts.csv&#39;</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">hrsa_tracts</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">all_rural_tracts</span><span class="p">[</span><span class="s1">&#39;Tract&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>
<span class="nb">type</span><span class="p">(</span><span class="n">hrsa_tracts</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>set</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Compare this to the number and percentage of rural tracts as defined by purely spatial</span>
<span class="c1"># relationships: a tract is rural if its spatial centroid is not contained within the polygon</span>
<span class="c1"># of a census urban area.</span>
<span class="c1"># 31.3% of census tracts are rural by the spatial definition. That&#39;s 73,056 census tracts of</span>
<span class="c1"># which 22,858 are rural. The UA and tract lists are from 2017.</span>
<span class="c1"># The HRSA/FORHP RUCA scores use 2010 data.</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Now get the enterprise counts and employment numbers from InfoGroup for both of these</span>
<span class="c1"># rurality concepts.</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">infile</span> <span class="o">=</span> <span class="s1">&#39;data/df_2017_OMB_Census_HRSA_FAR.csv&#39;</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">infile</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">object</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># &#39;Full Census Tract&#39; is the 11-digit tract ID</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;Full Census Tract&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="s1">&#39;999999999&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;Full Census Tract&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Full Census Tract&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;rural_updated_HRSA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Full Census Tract&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
    <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">hrsa_tracts</span> <span class="k">else</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;rural_updated_HRSA&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>0    13139051
1     1594386
Name: rural_updated_HRSA, dtype: int64</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Percentage of 2017 InfoGroup enterprises that are rural according to updated HRSA standard: &#39;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="n">rural</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;rural_updated_HRSA&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">total</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">rural</span><span class="o">/</span><span class="n">total</span> <span class="o">*</span> <span class="mf">100.0</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Percentage of 2017 InfoGroup enterprises that are rural according to updated HRSA standard: 10.821548291820843
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Employee Size (5) - Location&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Employee Size (5) - Location&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
<span class="n">total_emp</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Employee Size (5) - Location&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Total employment:&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">total_emp</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Total employment: 159762888.0
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">total_updated_HRSA</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;rural_updated_HRSA&#39;</span><span class="p">]</span>
                        <span class="o">==</span> <span class="mi">1</span><span class="p">][</span><span class="s1">&#39;Employee Size (5) - Location&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="n">pct</span> <span class="o">=</span> <span class="p">(</span><span class="n">total_updated_HRSA</span> <span class="o">/</span> <span class="n">total_emp</span><span class="p">)</span> <span class="o">*</span> <span class="mf">100.0</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Updated HRSA rural percentage employment:&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">pct</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Updated HRSA rural percentage employment: 9.456448984572688
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Now the same for the tract-spatial standard.</span>
<span class="n">df_spatial</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span>
    <span class="s1">&#39;/InfoGroup/rural/points-in-polygons/data/all_tracts.csv&#39;</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">object</span><span class="p">)</span>
<span class="n">df_spatial</span><span class="p">[</span><span class="s1">&#39;rural_tract&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>0    50198
1    22858
Name: rural_tract, dtype: int64</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">spatial_tracts</span> <span class="o">=</span> <span class="n">df_spatial</span><span class="p">[</span><span class="n">df_spatial</span><span class="p">[</span><span class="s1">&#39;rural_tract&#39;</span><span class="p">]</span>
                            <span class="o">==</span> <span class="s1">&#39;1&#39;</span><span class="p">][</span><span class="s1">&#39;GEOID&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%</span> <span class="o">%</span> <span class="n">time</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;rural_spatial_tracts&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Full Census Tract&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
    <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">spatial_tracts</span> <span class="k">else</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;rural_spatial_tracts&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>CPU times: user 1h 17min 10s, sys: 616 ms, total: 1h 17min 11s
Wall time: 1h 17min 9s
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>0    12940369
1     1793068
Name: rural_spatial_tracts, dtype: int64</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Percentage of InfoGroup enterprises located in a spatially defined rural census tract.</span>
<span class="mi">1793068</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)</span> <span class="o">*</span> <span class="mf">100.0</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>12.170059165420804</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">total_spatial_tracts</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;rural_spatial_tracts&#39;</span><span class="p">]</span>
                          <span class="o">==</span> <span class="mi">1</span><span class="p">][</span><span class="s1">&#39;Employee Size (5) - Location&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="n">pct</span> <span class="o">=</span> <span class="p">(</span><span class="n">total_spatial_tracts</span> <span class="o">/</span> <span class="n">total_emp</span><span class="p">)</span> <span class="o">*</span> <span class="mf">100.0</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Spatially defined rural census tracts percentage employment:&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">pct</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Spatially defined rural census tracts percentage employment: 10.553179909967577
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;data/df_2017_OMB_Census_HRSA_FAR_tracts.csv&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># How much overlap is there between the HRSA-revised and the spatial lists of rural census tracts?</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data/df_2017_OMB_Census_HRSA_FAR_tracts.csv&#39;</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">object</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">columns</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>Index([&#39;Company&#39;, &#39;Address Line 1&#39;, &#39;City&#39;, &#39;State&#39;, &#39;ZipCode&#39;, &#39;County Code&#39;,
       &#39;Primary SIC Code&#39;, &#39;SIC6_Descriptions&#39;, &#39;Primary NAICS Code&#39;,
       &#39;NAICS8 Descriptions&#39;, &#39;Employee Size (5) - Location&#39;,
       &#39;Sales Volume (9) - Location&#39;, &#39;Business Status Code&#39;,
       &#39;Industry Specific First Byte&#39;, &#39;Year Established&#39;, &#39;ABI&#39;,
       &#39;Subsidiary Number&#39;, &#39;Parent Number&#39;, &#39;Parent Actual Employee Size&#39;,
       &#39;Parent Actual Sales Volume&#39;, &#39;Census Tract&#39;, &#39;Census Block&#39;,
       &#39;Latitude&#39;, &#39;Longitude&#39;, &#39;CBSA Code&#39;, &#39;CBSA Level&#39;, &#39;FIPS Code&#39;,
       &#39;State FIPS&#39;, &#39;Continental&#39;, &#39;NAICS2&#39;, &#39;NAICS2 desc&#39;, &#39;CBSA Level desc&#39;,
       &#39;rural_OMB&#39;, &#39;rural_Census_general&#39;, &#39;NAICS6&#39;, &#39;NAICS6 desc&#39;, &#39;UA&#39;,
       &#39;rural_Census&#39;, &#39;Full Census Tract&#39;, &#39;rural_HRSA&#39;, &#39;far1&#39;, &#39;far2&#39;,
       &#39;far3&#39;, &#39;far4&#39;, &#39;FAR Level&#39;, &#39;rural_updated_HRSA&#39;,
       &#39;rural_spatial_tracts&#39;],
      dtype=&#39;object&#39;)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">revised_set</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;rural_updated_HRSA&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;1&#39;</span><span class="p">][</span><span class="s1">&#39;ABI&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>
<span class="n">spatial_set</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;rural_spatial_tracts&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;1&#39;</span><span class="p">][</span><span class="s1">&#39;ABI&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">revised_set</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">spatial_set</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>1594386
1793068
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%</span> <span class="o">%</span> <span class="n">time</span>
<span class="n">l</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">r_not_in_s</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">revised_set</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">r</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">spatial_set</span><span class="p">:</span>
        <span class="n">l</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">r_not_in_s</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">),</span> <span class="s1">&#39;ABIs in revised_HRSA rural enterprises that are not among spatial rural enterprises.&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>436434 ABIs in revised_HRSA rural enterprises that are not among spatial rural enterprises.
CPU times: user 661 ms, sys: 23.4 ms, total: 684 ms
Wall time: 679 ms
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%</span> <span class="o">%</span> <span class="n">time</span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">s_not_in_r</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">spatial_set</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">s</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">revised_set</span><span class="p">:</span>
        <span class="n">n</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">s_not_in_r</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">n</span><span class="p">),</span> <span class="s1">&#39;ABIs in spatial rural enterprises that are not among revised_HRSA rural enterprises.&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>635116 ABIs in spatial rural enterprises that are not among revised_HRSA rural enterprises.
CPU times: user 744 ms, sys: 23.9 ms, total: 768 ms
Wall time: 763 ms
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">total_set</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">revised_set</span><span class="p">)</span> <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="n">spatial_set</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">total_set</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>2229502</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>14733437</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Employee Size (5) - Location&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Employee Size (5) - Location&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
<span class="n">total_tracts</span> <span class="o">=</span> <span class="n">df</span><span class="p">[(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;rural_spatial_tracts&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;1&#39;</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;rural_updated_HRSA&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;1&#39;</span><span class="p">)][</span><span class="s1">&#39;Employee Size (5) - Location&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="n">pct</span> <span class="o">=</span> <span class="p">(</span><span class="n">total_tracts</span> <span class="o">/</span> <span class="mf">159762888.0</span><span class="p">)</span> <span class="o">*</span> <span class="mf">100.0</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Total rural census tracts percentage employment:&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">pct</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Total rural census tracts percentage employment: 13.362190848728272
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

</div>
 

