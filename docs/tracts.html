---

title: Title

keywords: fastai
sidebar: home_sidebar



---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: 06-HRSA_tracts.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># &quot;There are measurement challenges with both the Census and OMB definitions. Some policy </span>
<span class="c1"># experts note that the Census definition classifies quite a bit of suburban area as rural. </span>
<span class="c1"># The OMB definition includes rural areas in Metropolitan counties including, for example, </span>
<span class="c1"># the Grand Canyon which is located in a Metro county. Consequently, one could argue that the </span>
<span class="c1"># Census Bureau standard includes an overcount of the rural population whereas the OMB standard </span>
<span class="c1"># represents an undercount.&quot; </span>

<span class="c1"># To get the locations that are rural by HRSA definition, add these census tracts in metro/micro </span>
<span class="c1"># counties to the non-metro/micro counties in the OMB definition. (HRSA is the Health Resources </span>
<span class="c1"># and Services Administration. A unit of HRSA is the Federal Office of Rural Health Policy </span>
<span class="c1"># (FORHP). FORHP is the unit that defines &#39;rural&#39; in a way that is different from OMB and Census.</span>

<span class="c1"># The HRSA definition, in other words, is a refinement on the OMB definition. The Census </span>
<span class="c1"># definition is unrelated to either and later notebooks show that it incorporates the largest </span>
<span class="c1"># number of InfoGroup firms and the largest quantity of rural employment.</span>

<span class="c1"># from: https://www.hrsa.gov/rural-health/about-us/definition/index.html(the first paragraph is </span>
<span class="c1"># also from this source):</span>
<span class="c1"># &quot;The FORHP accepts all non-Metro counties as rural and uses an additional method of determining </span>
<span class="c1"># rurality called the Rural-Urban Commuting Area (RUCA) codes.&quot; RUCA codes are computed from </span>
<span class="c1"># Census data. See </span>
<span class="c1"># https://www.ers.usda.gov/topics/rural-economy-population.aspx and </span>
<span class="c1"># https://www.ers.usda.gov/data-products/rural-urban-commuting-area-codes/</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># This is not the same universe as the ACP project. They &quot;focus on the counties in which more than 80% of a given </span>
<span class="c1"># county falls into the HRSA rural definition.&quot; This is not clear. 80% of what? Probably area, but in any case, </span>
<span class="c1"># their definition applies to whole counties.</span>

<span class="c1"># To the extent that our analysis is based on individual businesses, we can locate observations within</span>
<span class="c1"># areas that are wholly rural; i.e., non-metro counties and rural census tracts in metro counties as defined by</span>
<span class="c1"># HRSA/FORHP. </span>

<span class="c1"># At the bottom of this notebook we add flags to identify a record as &#39;rural&#39; in each of the three </span>
<span class="c1"># (OMB, Census, HRSA) criteria.</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">PyPDF2</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Source: https://www.hrsa.gov/sites/default/files/hrsa/ruralhealth/resources/forhpeligibleareas.pdf</span>
<span class="n">infile</span> <span class="o">=</span> <span class="s1">&#39;/InfoGroup/rural/data/FORHP_eligibleareas.pdf&#39;</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># pdf file object</span>
<span class="n">pdfFileObj</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">infile</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span>
<span class="c1"># pdf reader object</span>
<span class="n">pdfReader</span> <span class="o">=</span> <span class="n">PyPDF2</span><span class="o">.</span><span class="n">PdfFileReader</span><span class="p">(</span><span class="n">pdfFileObj</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># number of pages in pdf</span>
<span class="n">npages</span> <span class="o">=</span> <span class="n">pdfReader</span><span class="o">.</span><span class="n">numPages</span>
<span class="n">npages</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>48</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pages</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">pg</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">npages</span><span class="p">):</span>
    <span class="c1"># a page object</span>
    <span class="n">pageObj</span> <span class="o">=</span> <span class="n">pdfReader</span><span class="o">.</span><span class="n">getPage</span><span class="p">(</span><span class="n">pg</span><span class="p">)</span>
    <span class="c1"># extracting text from page.</span>
    <span class="n">pages</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pageObj</span><span class="o">.</span><span class="n">extractText</span><span class="p">())</span>
    
<span class="n">pdfFileObj</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">pages</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>48</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pages</span><span class="p">[</span><span class="mi">19</span><span class="p">]</span>
<span class="c1"># Tract data begins at pages[19]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&#39;20 o\nf 48  Updated \n12/31/2018 \nSection II\n ALABAMA\n  Baldwin County\n  01003010100 \n 01003010200 \n\n 01003010500 \n\n 01003010600 \n\n 01003011000 \n\n 01003011401 \n\n 01003011403 \n\n 01003011406 \n\n 01003011407 \n\n 01003011408 \n\n 01003011501 \n\n 01003011502 \n\n 01003011601 \n Blount County\n  01009050101 \n 01009050102 \n\n 01009050300 \n\n 01009050400 \n Chilton County\n  01021060101 \n 01021060102 \n\n 01021060200 \n\n 01021060500 \n\n 01021060600 \n\n 01021060700 \n Elmore County\n  01051030400  \n\n Etowah County\n  01055011001 \n 01055011002 \n Geneva County\n  01061050100  \n Henry County\n  01067030300  \n\n Lawrence County\n  01079979400 \n 01079979800  \n Limestone County\n  01083020201 \n 01083020202 \n\n 01083020300 \n\n 01083020401 \n\n 01083020402 \n\n 01083020500 \n\n 01083020600 \n\n 01083020700 \n\n 01083020900 \n\n 01083021000 \n\n 01083021100 \n Mobile County\n  01097007202  \n\n Morgan \nCounty\n  01103005600  \n\n Pickens\n County\n  01107050200  \n\n Shelby\n County\n  01117980000 \n\n St. Clair \nCounty\n  01115040201 \n 01115040203 \n\n 01115040204 \n\n 01115040205 \n Walker County \n 01127020900 \n 01127021100 \n\n 01127021200 \n ALASKA\n  Anchorage\n  02020000101 \n 02020002900 \n Fairbanks North Star\n  02090001700 \n 02090001800  02090001900 \n Matanuska\n-Susitna \n All census tracts in the \ncounty qualify as rural. \n ARIZONA\n  Cochise\n County\n  04003000100 \n 04003000201 \n\n 04003000202 \n\n 04003000203 \n\n 04003000301 \n\n 04003000303 \n\n 04003000400 \n\n 04003000500 \n\n 04003000600 \n\n 04003000700 \n\n 04003000800 \n\n 04003000901 \n\n 04003000902 \n\n 04003001000 \n\n 04003001100 \n\n 04003001200 \n Coconino County\n  04005001500 \n 04005001600 \n\n 04005001700 \n\n 04005002000 \n\n 04005002100 \n\n 04005002300 \n&#39;</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;/InfoGroup/rural/data/tract_data.txt&#39;</span><span class="p">,</span><span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fout</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">pg</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">19</span><span class="p">,</span><span class="mi">48</span><span class="p">):</span>
        <span class="n">fout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">pages</span><span class="p">[</span><span class="n">pg</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Extract just the tract IDs into a list. First 5 digits of Tract IDs are the same as the State/County FIPS code.</span>
<span class="n">tracts</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;/InfoGroup/rural/data/tract_data.tmp&#39;</span><span class="p">,</span><span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fin</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">fin</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="nb">chr</span><span class="p">(</span><span class="mi">32</span><span class="p">):</span>
            <span class="k">continue</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">isnumeric</span><span class="p">():</span> 
                    <span class="n">tracts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>
                <span class="k">pass</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">tracts</span><span class="p">))</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;/InfoGroup/rural/data/rural_census_tracts.lis&#39;</span><span class="p">,</span><span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fout</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">tracts</span><span class="p">:</span>
        <span class="n">fout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">t</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>2302
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">year</span> <span class="o">=</span> <span class="mi">2017</span>
<span class="n">infile</span> <span class="o">=</span> <span class="s1">&#39;data/df_</span><span class="si">%d</span><span class="s1">_OMB_Census.csv&#39;</span> <span class="o">%</span> <span class="n">year</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">infile</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="nb">object</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Census Tract&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="s1">&#39;999999&#39;</span><span class="p">,</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;FIPS Code&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="s1">&#39;99999&#39;</span><span class="p">,</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># As read in from the csv file, &#39;Census Tract&#39; and &#39;FIPS Code&#39; are strings that look like floats (e.g., 12345.0).</span>
<span class="c1"># So they cannot be changed directly to ints; they must first be made into floats.</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">astype</span><span class="p">({</span><span class="s1">&#39;Census Tract&#39;</span><span class="p">:</span><span class="s1">&#39;float&#39;</span><span class="p">,</span><span class="s1">&#39;FIPS Code&#39;</span><span class="p">:</span><span class="s1">&#39;float&#39;</span><span class="p">})</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">astype</span><span class="p">({</span><span class="s1">&#39;Census Tract&#39;</span><span class="p">:</span><span class="s1">&#39;int&#39;</span><span class="p">,</span><span class="s1">&#39;FIPS Code&#39;</span><span class="p">:</span><span class="s1">&#39;int&#39;</span><span class="p">,</span><span class="s1">&#39;rural_OMB&#39;</span><span class="p">:</span><span class="s1">&#39;int&#39;</span><span class="p">})</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># A census tract ID comparable to the 11-digit ones in the HRSA list is a combination of the</span>
<span class="c1"># &#39;FIPS Code&#39; and &#39;Census Tract&#39; columns in df (InfoGroup), as long as neither is missing.</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dfx</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Census Tract&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">999999</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">dfx</span><span class="p">))</span>
<span class="c1"># So very few missing values in the InfoGroup &#39;Census Tract&#39; variable.</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>14733437
18
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="k">def</span> <span class="nf">combo</span><span class="p">(</span><span class="n">row</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;FIPS Code&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">99999</span> <span class="ow">or</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Census Tract&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">999999</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;FIPS Code&#39;</span><span class="p">])</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Census Tract&#39;</span><span class="p">])</span>
        <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
            <span class="n">fips</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;FIPS Code&#39;</span><span class="p">]))</span>
            <span class="n">tract</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Census Tract&#39;</span><span class="p">]))</span>
            <span class="k">return</span> <span class="n">fips</span> <span class="o">+</span> <span class="n">tract</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%%time</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;Full Census Tract&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">combo</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>CPU times: user 17min 56s, sys: 12.2 s, total: 18min 9s
Wall time: 18min 9s
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dfy</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Full Census Tract&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">()]</span>
<span class="nb">len</span><span class="p">(</span><span class="n">dfy</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>18</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">fct</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Full Census Tract&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">fct</span><span class="p">))</span>
<span class="n">fct_set</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">fct</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">fct_set</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>14733437
82385
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">rural_tracts</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">tracts</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">rural_tracts</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>2302</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">rur3</span><span class="p">(</span><span class="n">row</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;rural_OMB&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">or</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Full Census Tract&#39;</span><span class="p">]</span> <span class="ow">in</span> <span class="n">rural_tracts</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="mi">0</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%%time</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;rural_HRSA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">rur3</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>CPU times: user 11min 42s, sys: 9.64 s, total: 11min 52s
Wall time: 11min 51s
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;rural_HRSA&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>0    13740765
1      992672
Name: rural_HRSA, dtype: int64</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;rural_HRSA&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">(</span><span class="n">normalize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>0    93.262455
1     6.737545
Name: rural_HRSA, dtype: float64</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Rural businesses by the HRSA definiton of rural are 6.74% of the total.</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">outfile</span> <span class="o">=</span> <span class="s1">&#39;data/df_</span><span class="si">%d</span><span class="s1">_OMB_Census_HRSA.csv&#39;</span> <span class="o">%</span> <span class="n">year</span>
<span class="n">df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">outfile</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># -----------------------</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># InfoGroup for 2017 has data on 82,385 census tracts for all (above). The HRSA/FORHP file </span>
<span class="c1"># of rural units lists 2,302 rural census tracts in addition to all those in non-Metro counties. The Census&#39;s </span>
<span class="c1"># Zip Code-to-Census Tracts relationship file identifies 74,091 census tracts in all states(below).</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># The ID of a census tract is the combination of the state FIPS, county FIPS, and tract number.</span>
<span class="n">infile</span> <span class="o">=</span> <span class="s1">&#39;/home/tflory/Relationship_Files/Census_Tract_to_PUMA.csv&#39;</span>
<span class="n">ct_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">infile</span><span class="p">,</span><span class="n">usecols</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;STATEFP&#39;</span><span class="p">,</span><span class="s1">&#39;COUNTYFP&#39;</span><span class="p">,</span><span class="s1">&#39;TRACTCE&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">ct_df</span><span class="p">[</span><span class="s1">&#39;STATEFP&#39;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="mi">56</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>74091</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

</div>
 

