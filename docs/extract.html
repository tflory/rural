---

title: Title

keywords: fastai
sidebar: home_sidebar



---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: 00-data_extract.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">zipfile</span> <span class="kn">import</span> <span class="n">ZipFile</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">cols</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Company&#39;</span><span class="p">,</span><span class="s1">&#39;Address Line 1&#39;</span><span class="p">,</span><span class="s1">&#39;City&#39;</span><span class="p">,</span><span class="s1">&#39;State&#39;</span><span class="p">,</span><span class="s1">&#39;ZipCode&#39;</span><span class="p">,</span><span class="s1">&#39;Employee Size (5) - Location&#39;</span><span class="p">,</span>
        <span class="s1">&#39;County Code&#39;</span><span class="p">,</span><span class="s1">&#39;Sales Volume (9) - Location&#39;</span><span class="p">,</span><span class="s1">&#39;Primary NAICS Code&#39;</span><span class="p">,</span><span class="s1">&#39;NAICS8 Descriptions&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Primary SIC Code&#39;</span><span class="p">,</span><span class="s1">&#39;SIC6_Descriptions&#39;</span><span class="p">,</span><span class="s1">&#39;Business Status Code&#39;</span><span class="p">,</span> 
        <span class="s1">&#39;Industry Specific First Byte&#39;</span><span class="p">,</span><span class="s1">&#39;Year Established&#39;</span><span class="p">,</span><span class="s1">&#39;Subsidiary Number&#39;</span><span class="p">,</span> <span class="s1">&#39;Parent Number&#39;</span><span class="p">,</span> 
        <span class="s1">&#39;Parent Actual Employee Size&#39;</span><span class="p">,</span><span class="s1">&#39;Parent Actual Sales Volume&#39;</span><span class="p">,</span><span class="s1">&#39;ABI&#39;</span><span class="p">,</span><span class="s1">&#39;Census Tract&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Census Block&#39;</span><span class="p">,</span><span class="s1">&#39;Latitude&#39;</span><span class="p">,</span><span class="s1">&#39;Longitude&#39;</span><span class="p">,</span><span class="s1">&#39;CBSA Code&#39;</span><span class="p">,</span><span class="s1">&#39;CBSA Level&#39;</span><span class="p">,</span><span class="s1">&#39;FIPS Code&#39;</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Assign the FIPS state code to each record. Prior examination shows some data entry </span>
<span class="c1"># errors in the FIPS Code variable so we do this by brute force.</span>
<span class="n">state_fips</span> <span class="o">=</span> <span class="p">{</span>
<span class="s1">&#39;AL&#39;</span><span class="p">:</span><span class="s1">&#39;01&#39;</span><span class="p">,</span>
<span class="s1">&#39;AK&#39;</span><span class="p">:</span><span class="s1">&#39;02&#39;</span><span class="p">,</span>
<span class="s1">&#39;AS&#39;</span><span class="p">:</span><span class="s1">&#39;60&#39;</span><span class="p">,</span>
<span class="s1">&#39;AZ&#39;</span><span class="p">:</span><span class="s1">&#39;04&#39;</span><span class="p">,</span>
<span class="s1">&#39;AR&#39;</span><span class="p">:</span><span class="s1">&#39;05&#39;</span><span class="p">,</span>
<span class="s1">&#39;CA&#39;</span><span class="p">:</span><span class="s1">&#39;06&#39;</span><span class="p">,</span>
<span class="s1">&#39;CO&#39;</span><span class="p">:</span><span class="s1">&#39;08&#39;</span><span class="p">,</span>
<span class="s1">&#39;CT&#39;</span><span class="p">:</span><span class="s1">&#39;09&#39;</span><span class="p">,</span>
<span class="s1">&#39;DE&#39;</span><span class="p">:</span><span class="s1">&#39;10&#39;</span><span class="p">,</span>
<span class="s1">&#39;DC&#39;</span><span class="p">:</span><span class="s1">&#39;11&#39;</span><span class="p">,</span>
<span class="s1">&#39;FL&#39;</span><span class="p">:</span><span class="s1">&#39;12&#39;</span><span class="p">,</span>
<span class="s1">&#39;FM&#39;</span><span class="p">:</span><span class="s1">&#39;64&#39;</span><span class="p">,</span>
<span class="s1">&#39;GA&#39;</span><span class="p">:</span><span class="s1">&#39;13&#39;</span><span class="p">,</span>
<span class="s1">&#39;GU&#39;</span><span class="p">:</span><span class="s1">&#39;66&#39;</span><span class="p">,</span>
<span class="s1">&#39;HI&#39;</span><span class="p">:</span><span class="s1">&#39;15&#39;</span><span class="p">,</span>
<span class="s1">&#39;ID&#39;</span><span class="p">:</span><span class="s1">&#39;16&#39;</span><span class="p">,</span>
<span class="s1">&#39;IL&#39;</span><span class="p">:</span><span class="s1">&#39;17&#39;</span><span class="p">,</span>
<span class="s1">&#39;IN&#39;</span><span class="p">:</span><span class="s1">&#39;18&#39;</span><span class="p">,</span>
<span class="s1">&#39;IA&#39;</span><span class="p">:</span><span class="s1">&#39;19&#39;</span><span class="p">,</span>
<span class="s1">&#39;KS&#39;</span><span class="p">:</span><span class="s1">&#39;20&#39;</span><span class="p">,</span>
<span class="s1">&#39;KY&#39;</span><span class="p">:</span><span class="s1">&#39;21&#39;</span><span class="p">,</span>
<span class="s1">&#39;LA&#39;</span><span class="p">:</span><span class="s1">&#39;22&#39;</span><span class="p">,</span>
<span class="s1">&#39;ME&#39;</span><span class="p">:</span><span class="s1">&#39;23&#39;</span><span class="p">,</span>
<span class="s1">&#39;MH&#39;</span><span class="p">:</span><span class="s1">&#39;68&#39;</span><span class="p">,</span>
<span class="s1">&#39;MD&#39;</span><span class="p">:</span><span class="s1">&#39;24&#39;</span><span class="p">,</span>
<span class="s1">&#39;MA&#39;</span><span class="p">:</span><span class="s1">&#39;25&#39;</span><span class="p">,</span>
<span class="s1">&#39;MI&#39;</span><span class="p">:</span><span class="s1">&#39;26&#39;</span><span class="p">,</span>
<span class="s1">&#39;MN&#39;</span><span class="p">:</span><span class="s1">&#39;27&#39;</span><span class="p">,</span>
<span class="s1">&#39;MS&#39;</span><span class="p">:</span><span class="s1">&#39;28&#39;</span><span class="p">,</span>
<span class="s1">&#39;MO&#39;</span><span class="p">:</span><span class="s1">&#39;29&#39;</span><span class="p">,</span>
<span class="s1">&#39;MT&#39;</span><span class="p">:</span><span class="s1">&#39;30&#39;</span><span class="p">,</span>
<span class="s1">&#39;NE&#39;</span><span class="p">:</span><span class="s1">&#39;31&#39;</span><span class="p">,</span>
<span class="s1">&#39;NV&#39;</span><span class="p">:</span><span class="s1">&#39;32&#39;</span><span class="p">,</span>
<span class="s1">&#39;NH&#39;</span><span class="p">:</span><span class="s1">&#39;33&#39;</span><span class="p">,</span>
<span class="s1">&#39;NJ&#39;</span><span class="p">:</span><span class="s1">&#39;34&#39;</span><span class="p">,</span>
<span class="s1">&#39;NM&#39;</span><span class="p">:</span><span class="s1">&#39;35&#39;</span><span class="p">,</span>
<span class="s1">&#39;NY&#39;</span><span class="p">:</span><span class="s1">&#39;36&#39;</span><span class="p">,</span>
<span class="s1">&#39;NC&#39;</span><span class="p">:</span><span class="s1">&#39;37&#39;</span><span class="p">,</span>
<span class="s1">&#39;ND&#39;</span><span class="p">:</span><span class="s1">&#39;38&#39;</span><span class="p">,</span>
<span class="s1">&#39;MP&#39;</span><span class="p">:</span><span class="s1">&#39;69&#39;</span><span class="p">,</span>
<span class="s1">&#39;OH&#39;</span><span class="p">:</span><span class="s1">&#39;39&#39;</span><span class="p">,</span>
<span class="s1">&#39;OK&#39;</span><span class="p">:</span><span class="s1">&#39;40&#39;</span><span class="p">,</span>
<span class="s1">&#39;OR&#39;</span><span class="p">:</span><span class="s1">&#39;41&#39;</span><span class="p">,</span>
<span class="s1">&#39;PW&#39;</span><span class="p">:</span><span class="s1">&#39;70&#39;</span><span class="p">,</span>
<span class="s1">&#39;PA&#39;</span><span class="p">:</span><span class="s1">&#39;42&#39;</span><span class="p">,</span>
<span class="s1">&#39;PR&#39;</span><span class="p">:</span><span class="s1">&#39;72&#39;</span><span class="p">,</span>
<span class="s1">&#39;RI&#39;</span><span class="p">:</span><span class="s1">&#39;44&#39;</span><span class="p">,</span>
<span class="s1">&#39;SC&#39;</span><span class="p">:</span><span class="s1">&#39;45&#39;</span><span class="p">,</span>
<span class="s1">&#39;SD&#39;</span><span class="p">:</span><span class="s1">&#39;46&#39;</span><span class="p">,</span>
<span class="s1">&#39;TN&#39;</span><span class="p">:</span><span class="s1">&#39;47&#39;</span><span class="p">,</span>
<span class="s1">&#39;TX&#39;</span><span class="p">:</span><span class="s1">&#39;48&#39;</span><span class="p">,</span>
<span class="s1">&#39;UM&#39;</span><span class="p">:</span><span class="s1">&#39;74&#39;</span><span class="p">,</span>
<span class="s1">&#39;UT&#39;</span><span class="p">:</span><span class="s1">&#39;49&#39;</span><span class="p">,</span>
<span class="s1">&#39;VT&#39;</span><span class="p">:</span><span class="s1">&#39;50&#39;</span><span class="p">,</span>
<span class="s1">&#39;VA&#39;</span><span class="p">:</span><span class="s1">&#39;51&#39;</span><span class="p">,</span>
<span class="s1">&#39;VI&#39;</span><span class="p">:</span><span class="s1">&#39;78&#39;</span><span class="p">,</span>
<span class="s1">&#39;WA&#39;</span><span class="p">:</span><span class="s1">&#39;53&#39;</span><span class="p">,</span>
<span class="s1">&#39;WV&#39;</span><span class="p">:</span><span class="s1">&#39;54&#39;</span><span class="p">,</span>
<span class="s1">&#39;WI&#39;</span><span class="p">:</span><span class="s1">&#39;55&#39;</span><span class="p">,</span>
<span class="s1">&#39;WY&#39;</span><span class="p">:</span><span class="s1">&#39;56&#39;</span>
<span class="p">}</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Short descriptions for 2-digit NAICS codes</span>
<span class="n">naics_desc</span> <span class="o">=</span> <span class="p">{</span>
<span class="s1">&#39;11&#39;</span><span class="p">:</span><span class="s1">&#39;Agriculture, Forestry, Fishing and Hunting&#39;</span><span class="p">,</span>
<span class="s1">&#39;21&#39;</span><span class="p">:</span><span class="s1">&#39;Mining&#39;</span><span class="p">,</span>
<span class="s1">&#39;22&#39;</span><span class="p">:</span><span class="s1">&#39;Utilities&#39;</span><span class="p">,</span>
<span class="s1">&#39;23&#39;</span><span class="p">:</span><span class="s1">&#39;Construction&#39;</span><span class="p">,</span>
<span class="s1">&#39;31&#39;</span><span class="p">:</span><span class="s1">&#39;Manufacturing&#39;</span><span class="p">,</span>
<span class="s1">&#39;32&#39;</span><span class="p">:</span><span class="s1">&#39;Manufacturing&#39;</span><span class="p">,</span>
<span class="s1">&#39;33&#39;</span><span class="p">:</span><span class="s1">&#39;Manufacturing&#39;</span><span class="p">,</span>
<span class="s1">&#39;42&#39;</span><span class="p">:</span><span class="s1">&#39;Wholesale Trade&#39;</span><span class="p">,</span>
<span class="s1">&#39;44&#39;</span><span class="p">:</span><span class="s1">&#39;Retail Trade&#39;</span><span class="p">,</span>
<span class="s1">&#39;45&#39;</span><span class="p">:</span><span class="s1">&#39;Retail Trade&#39;</span><span class="p">,</span>
<span class="s1">&#39;48&#39;</span><span class="p">:</span><span class="s1">&#39;Transportation and Warehousing&#39;</span><span class="p">,</span>
<span class="s1">&#39;49&#39;</span><span class="p">:</span><span class="s1">&#39;Transportation and Warehousing&#39;</span><span class="p">,</span>
<span class="s1">&#39;51&#39;</span><span class="p">:</span><span class="s1">&#39;Information&#39;</span><span class="p">,</span>
<span class="s1">&#39;52&#39;</span><span class="p">:</span><span class="s1">&#39;Finance and Insurance&#39;</span><span class="p">,</span>
<span class="s1">&#39;53&#39;</span><span class="p">:</span><span class="s1">&#39;Real Estate Rental and Leasing&#39;</span><span class="p">,</span>
<span class="s1">&#39;54&#39;</span><span class="p">:</span><span class="s1">&#39;Professional, Scientific, and Technical Services&#39;</span><span class="p">,</span>
<span class="s1">&#39;55&#39;</span><span class="p">:</span><span class="s1">&#39;Management of Companies and Enterprises&#39;</span><span class="p">,</span>
<span class="s1">&#39;56&#39;</span><span class="p">:</span><span class="s1">&#39;Administrative and Support and Waste Management and Remediation Services&#39;</span><span class="p">,</span>
<span class="s1">&#39;61&#39;</span><span class="p">:</span><span class="s1">&#39;Eucational Services&#39;</span><span class="p">,</span>
<span class="s1">&#39;62&#39;</span><span class="p">:</span><span class="s1">&#39;Health Care and Social Assistance&#39;</span><span class="p">,</span>
<span class="s1">&#39;71&#39;</span><span class="p">:</span><span class="s1">&#39;Arts, Entertainment, and Recreation&#39;</span><span class="p">,</span>
<span class="s1">&#39;72&#39;</span><span class="p">:</span><span class="s1">&#39;Accommodation and Food Services&#39;</span><span class="p">,</span>
<span class="s1">&#39;81&#39;</span><span class="p">:</span><span class="s1">&#39;Other Services (except Public Administration)&#39;</span><span class="p">,</span>
<span class="s1">&#39;92&#39;</span><span class="p">:</span><span class="s1">&#39;Public Administration&#39;</span><span class="p">,</span>
<span class="s1">&#39;99&#39;</span><span class="p">:</span><span class="s1">&#39;Unknown&#39;</span>
<span class="p">}</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Little functions</span>
<span class="k">def</span> <span class="nf">state_code</span><span class="p">(</span><span class="n">state</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Establish an accurate state FIPS code&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">state_fips</span><span class="p">[</span><span class="n">state</span><span class="p">]</span>

<span class="k">def</span> <span class="nf">is_continental</span><span class="p">(</span><span class="n">code</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Create a 1/0 flag for the 48 continental states and DC, excluding HI and AK. </span>
<span class="sd">        This could be useful for mapping.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="n">code</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">15</span><span class="p">]:</span>
        <span class="k">return</span> <span class="s1">&#39;1&#39;</span>
    <span class="k">return</span> <span class="s1">&#39;0&#39;</span>

<span class="k">def</span> <span class="nf">two_digit</span><span class="p">(</span><span class="n">code</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Create a new 2-digit NAICS code variable from the 8-digit Primary NAICS Code&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">code</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span>

<span class="k">def</span> <span class="nf">desc</span><span class="p">(</span><span class="n">code</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Create a variable with text descriptions of the 2-digit NAICS codes&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">naics_desc</span><span class="p">[</span><span class="n">code</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">for</span> <span class="n">yr</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1998</span><span class="p">,</span><span class="mi">2017</span><span class="p">):</span>
    <span class="nb">dir</span> <span class="o">=</span> <span class="s1">&#39;/InfoGroup/data/original/&#39;</span>
    <span class="n">xdir</span> <span class="o">=</span> <span class="s1">&#39;/tmp/xtrcts/&#39;</span>
    <span class="n">fname</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">yr</span><span class="si">}</span><span class="s1">_Business_Academic_QCQ_utf-8.&#39;</span>
    <span class="k">with</span> <span class="n">ZipFile</span><span class="p">(</span><span class="nb">dir</span> <span class="o">+</span> <span class="n">fname</span> <span class="o">+</span> <span class="s1">&#39;zip&#39;</span><span class="p">,</span><span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">myzip</span><span class="p">:</span>
        <span class="n">myzip</span><span class="o">.</span><span class="n">extract</span><span class="p">(</span><span class="n">fname</span> <span class="o">+</span> <span class="s1">&#39;csv&#39;</span><span class="p">,</span><span class="n">xdir</span><span class="p">)</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">xdir</span> <span class="o">+</span> <span class="n">fname</span> <span class="o">+</span> <span class="s1">&#39;csv&#39;</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="nb">object</span><span class="p">,</span><span class="n">usecols</span><span class="o">=</span><span class="n">cols</span><span class="p">)</span>

        <span class="c1"># Overwrite the state FIPS code</span>
        <span class="n">df</span><span class="p">[</span><span class="s1">&#39;State FIPS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;State&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">state_code</span><span class="p">)</span>
        <span class="n">df</span><span class="p">[</span><span class="s1">&#39;State FIPS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;State FIPS&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
        
        <span class="c1"># Exclude territories, leaving only the 50 states and DC.</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;State FIPS&#39;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="mi">56</span><span class="p">]</span>
        
        <span class="c1"># Flag the 48 continental states</span>
        <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Continental&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;State FIPS&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">is_continental</span><span class="p">)</span>
        
        <span class="c1"># Give &#39;Primary NAICS Code&#39; a useable missing value.</span>
        <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Primary NAICS Code&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="s1">&#39;99999999&#39;</span><span class="p">,</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        
        <span class="c1"># Give &#39;CBSA Level&#39; a missing value of 0.</span>
        <span class="n">df</span><span class="p">[</span><span class="s1">&#39;CBSA Level&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="s1">&#39;0&#39;</span><span class="p">,</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        
        <span class="c1"># Create 2-digit NAICS code</span>
        <span class="n">df</span><span class="p">[</span><span class="s1">&#39;NAICS2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Primary NAICS Code&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">two_digit</span><span class="p">)</span>
        
        <span class="c1"># Create descriptions of the 2-digit NAICS codes</span>
        <span class="n">df</span><span class="p">[</span><span class="s1">&#39;NAICS2 desc&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;NAICS2&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">desc</span><span class="p">)</span>
        
        <span class="c1"># Write out the enhanced extract csv file</span>
        <span class="n">outfile</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;/InfoGroup/data/rurality/df_</span><span class="si">{</span><span class="n">yr</span><span class="si">}</span><span class="s1">_uncorrected.csv&#39;</span>
        <span class="n">df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">outfile</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
        
        <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">xdir</span> <span class="o">+</span> <span class="n">fname</span> <span class="o">+</span> <span class="s1">&#39;csv&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

</div>
 

